<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Official hub for all Xiao Zhan social media accounts and latest updates">
    <title>Xiao Zhan Social Media Hub</title>
    <!-- Preload key assets -->
    <link rel="preload" href="xiao-zhan.jpg" as="image">
    <!-- CSS STYLES - Optimized and minified -->
    <style>

    .music-player {
        position: fixed;
        bottom: 20px;
        right: 5px;
        z-index: 1000;
        background-color: rgba(255, 255, 255, 0.9);
        border-radius: 50px;
        padding: 8px 16px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        display: flex;
        align-items: center;
        transition: all 0.3s ease;
    }
    
    .music-controls {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .play-btn, .control-btn {
        background-color: var(--primary-color);
        color: white;
        border: none;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        font-size: 14px;
    }
    
    .play-btn:hover, .control-btn:hover {
        background-color: #1a252f;
        transform: scale(1.1);
    }
    
    .track-info {
        margin-left: 10px;
        font-size: 0.9rem;
        color: var(--text-color);
        white-space: nowrap;
        max-width: 150px;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    
    @media (max-width: 768px) {
        .music-player {
            bottom: 10px;
            right: 10px;
            padding: 6px 12px;
        }
        
        .track-info {
            max-width: 100px;
        }
    }

        :root {
            --primary-color: #CC9933;
            --background-color: #f4f4f4;
            --text-color: #333;
            --card-shadow: 0 4px 8px rgba(0,0,0,0.1);
            --card-shadow-hover: 0 10px 20px rgba(0,0,0,0.15);
            --weibo-color: #B7950B;
            --douyin-color: #666600;
            --youtube-color: #CC6600;
            --xiaohongshu-color: #fe2c55;
            --bilibili-color: #00a1d6;
            --wechat-color: #07C160;
            --video-color: #660033;
            --baiduwiki-color: #669999;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
        }
        
        header {
            background-color: var(--primary-color);
            color: white;
            text-align: center;
            padding: 2rem 0;
            position: relative;
        }
        
        .profile-img {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 5px solid white;
            margin-bottom: 1rem;
        }
        
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 2rem;
        }
        
        .social-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .social-card {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            height: 100%;
        }
        
        .social-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--card-shadow-hover);
        }
        
        .card-header {
            padding: 1.5rem;
            color: white;
            text-align: center;
        }
        
        .card-body {
            padding: 1.5rem;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 200px;
        }
        
        .card-info {
            flex-grow: 1;
        }
        
        .card-button {
            margin-top: 1.5rem;
        }
        
        .btn {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: 0.8rem 1.5rem;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }
        
        .btn:hover {
            background-color: #1a252f;
        }
        
        /* Platform specific colors */
        .weibo { background-color: var(--weibo-color); }
        .douyin { background-color: var(--douyin-color); }
        .baidu, .wikipedia { background-color: var(--baiduwiki-color); }
        .instagram { background-color: var(--youtube-color); }
        .twitter { background-color: #1DA1F2; }
        .wechat { background-color: var(--wechat-color); }
        .bilibili { background-color: var(--bilibili-color); }
        .xiaohongshu { background-color: var(--xiaohongshu-color); }
        .youtube { background-color: var(--youtube-color); }
        .tencent, .youku, .iqiyi { background-color: var(--video-color); }
        
        .footer {
            text-align: center;
            padding: 2rem 0;
            background-color: var(--primary-color);
            color: white;
            margin-top: 3rem;
        }
        
        .latest-news {
            margin-top: 3rem;
            background-color: white;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: var(--card-shadow);
        }
        
        .news-item {
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #eee;
        }
        
        .news-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .work-item {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            transition: transform 0.3s;
        }
        
        .work-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .work-title {
            font-size: 1.5rem;
            color: var(--primary-color);
            margin-bottom: 10px;
        }



        /* Mobile responsive adjustments */
        @media (max-width: 768px) {
            .social-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .container {
                padding: 0 1rem;
            }
        }
        
        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Email Contact Form Styles */
        .contact-section {
            max-width: 800px;
            margin: 40px auto;
            background-color: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 20px;
            color: var(--primary-color);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        .form-group textarea {
            min-height: 150px;
            resize: vertical;
        }
        
        .submit-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }
        
        .submit-btn:hover {
            background-color: var(--accent-color);
        }

    </style>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9HHY88KW0F"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9HHY88KW0F');
</script>

</head>
<body>

<div class="music-player">
    <audio id="background-music">
        <!-- Your tracks will be loaded here via JavaScript -->
    </audio>
    <div class="music-controls">
        <button id="prev-track" class="control-btn">‚èÆÔ∏è</button>
        <button id="music-toggle" class="play-btn">
            <span class="music-icon">‚ñ∂Ô∏è</span>
        </button>
        <button id="next-track" class="control-btn">‚è≠Ô∏è</button>
        <button id="shuffle-toggle" class="control-btn">üîÄ</button>
        <span id="track-name" class="track-info">Select a track</span>
    </div>
</div>

    <!-- HEADER SECTION -->
    <header>
        <img src="xiao-zhan.jpg" alt="Xiao Zhan" class="profile-img" id="profile-img">
        <h1>Xiao Zhan (ËÇñÊàò) Social Media Hub</h1>
        <p>All of Xiao Zhan's official social media accounts in one place</p>
    </header>

    <div class="container">
        <!-- Traffic Analytics Dashboard (only visible to admin) -->
        <div class="analytics-container" id="analytics-container" style="display:none;">
            <h2>Fan Community Stats</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Page Views</h3>
                    <div class="stat-number" id="page-views">0</div>
                    <div class="stat-label">Total Views</div>
                </div>
                <div class="stat-card">
                    <h3>Visitors</h3>
                    <div class="stat-number" id="unique-visitors">0</div>
                    <div class="stat-label">Unique Fans</div>
                </div>
                <div class="stat-card">
                    <h3>Today</h3>
                    <div class="stat-number" id="today-visits">0</div>
                    <div class="stat-label">Today's Visits</div>
                </div>
                <div class="stat-card">
                    <h3>Fan Growth</h3>
                    <div class="stat-number" id="growth-rate">0%</div>
                    <div class="stat-label">Weekly Growth</div>
                </div>
            </div>
        </div>

        <!-- SOCIAL MEDIA CARDS -->
        <div class="social-grid" id="social-grid">
            <!-- Weibo Cards -->
            <div class="social-card">
                <div class="card-header weibo">
                    <h2>ËÇñÊàòÂæÆÂçö</h2>
                </div>
                <div class="card-body">
                    <div class="card-info">
                        <p>Follow Xiao Zhan's official Weibo account for updates and announcements.</p>
                        <p>Followers: 30M+</p>
                    </div>
                    <div class="card-button">
                        <a href="https://weibo.com/u/1792951112" class="btn weibo" target="_blank" data-platform="weibo-personal">Visit Weibo</a>
                    </div>
                </div>
            </div>
            
            <div class="social-card">
                <div class="card-header weibo">
                    <h2>ËÇñÊàòÂ∑•‰ΩúÂÆ§ÂæÆÂçö</h2>
                </div>
                <div class="card-body">
                    <div class="card-info">
                        <p>Follow XZ.STUDIO.'s official Weibo account for updates and announcements.</p>
                        <p>Followers: 10M+</p>
                    </div>
                    <div class="card-button">
                        <a href="https://weibo.com/u/6643123988" class="btn weibo" target="_blank" data-platform="weibo-studio">Visit Weibo</a>
                    </div>
                </div>
            </div>
            
            <div class="social-card">
                <div class="card-header weibo">
                    <h2>ËÇñÊàòË∂ÖËØù</h2>
                </div>
                <div class="card-body">
                    <div class="card-info">
                        <p>Join and have fun in Weibo Supertopic.</p>
                        <p>Followers: 10M+</p>
                    </div>
                    <div class="card-button">
                        <a href="https://weibo.com/p/100808f57b3faeb25f86b43a8cc58f02286f40/super_index" class="btn weibo" target="_blank" data-platform="weibo-supertopic">Visit Weibo</a>
                    </div>
                </div>
            </div>
            
            <div class="social-card">
                <div class="card-header douyin">
                    <h2>ËÇñÊàòÊäñÈü≥</h2>
                </div>
                <div class="card-body">
                    <div class="card-info">
                        <p>Watch Xiao Zhan's short videos and behind-the-scenes content on Douyin.</p>
                        <p>Followers: 20M+</p>
                    </div>
                    <div class="card-button">
                        <a href="https://www.douyin.com/user/MS4wLjABAAAAp5h2oXaBBs4Addlh36wkxtk3srSPYe380PBewEe1si9OnrF_Sy8eZpdJQ_NYBl6H?from_tab_name=main" class="btn douyin" target="_blank" data-platform="douyin-personal">Visit Douyin</a>
                    </div>
                </div>
            </div>
            
            <div class="social-card">
                <div class="card-header douyin">
                    <h2>ËÇñÊàòÂ∑•‰ΩúÂÆ§ÊäñÈü≥</h2>
                </div>
                <div class="card-body">
                    <div class="card-info">
                        <p>Watch XZ.STUDIO.'s short videos and behind-the-scenes content on Douyin.</p>
                        <p>Followers: 7M+</p>
                    </div>
                    <div class="card-button">
                        <a href="https://www.douyin.com/user/MS4wLjABAAAAbeJEodUTXohdleqNzCo2PZ-XsY2G6JGQ3HUT0uDtQ-A?from_tab_name=main" class="btn douyin" target="_blank" data-platform="douyin-studio">Visit Douyin</a>
                    </div>
                </div>
            </div>
            
            <div class="social-card">
                <div class="card-header douyin">
                    <h2>ËÇñÊàòÂΩ±Èü≥‰ºöÊäñÈü≥</h2>
                </div>
                <div class="card-body">
                    <div class="card-info">
                        <p>XZ Fanclub on DOUYINÔºö19911005xzyyh</p>
                        <p>Followers: 1M+</p>
                    </div>
                    <div class="card-button">
                        <a href="https://www.douyin.com/user/MS4wLjABAAAAqC4DjHo_8kZSQV9bCTwoOgBbpaxksndgz8kzP96Q6bI?from_tab_name=main" class="btn douyin" target="_blank" data-platform="douyin-fanclub">Visit Douyin</a>
                    </div>
                </div>
            </div>
            
            <div class="social-card">
                <div class="card-header baidu">
                    <h2>ÁôæÂ∫¶ËÇñÊàòÂ∑•‰ΩúÂÆ§</h2>
                </div>
                <div class="card-body">
                    <div class="card-info">
                        <p>Follow XZ Studio's official Baidu account for updates and content.</p>
                        <p>Official studio account</p>
                    </div>
                    <div class="card-button">
                        <a href="https://author.baidu.com/home?type=profile&action=profile&mthfr=box_share&context=%7B%22from%22%3A%22dusite_sresults%22%2C%22uk%22%3A%226REHqK7YhHdA6m4t1rk1Uw%22%2C%22tab%22%3A%22dynamicList%22%7D" class="btn baidu" target="_blank" data-platform="baidu-studio">Visit Baidu</a>
                    </div>
                </div>
            </div>
            
            <div class="social-card">
                <div class="card-header baidu">
                    <h2>ËÇñÊàòÁôæÂ∫¶ÁôæÁßë</h2>
                </div>
                <div class="card-body">
                    <div class="card-info">
                        <p>Learn about Xiao Zhan's biography, career, and achievements on Baidu Baike.</p>
                        <p>Encyclopedia and reference</p>
                    </div>
                    <div class="card-button">
                        <a href="https://baike.baidu.com/item/%E8%82%96%E6%88%98/18866899" class="btn baidu" target="_blank" data-platform="baidu-baike">Visit Baidu Baike</a>
                    </div>
                </div>
            </div>
            
            <div class="social-card">
                <div class="card-header wikipedia">
                    <h2>ËÇñÊàòÁª¥Âü∫ÁôæÁßë</h2>
                </div>
                <div class="card-body">
                    <div class="card-info">
                        <p>View Xiao Zhan's Wikipedia page for his biography and career information.</p>
                        <p>Open encyclopedia</p>
                    </div>
                    <div class="card-button">
                        <a href="https://zh.wikipedia.org/zh-cn/%E8%82%96%E6%88%B0" class="btn wikipedia" target="_blank" data-platform="wikipedia">Visit Wikipedia</a>
                    </div>
                </div>
            </div>
            
            <div class="social-card">
                <div class="card-header instagram">
                    <h2>ËÇñÊàòInstagram</h2>
                </div>
                <div class="card-body">
                    <div class="card-info">
                        <p>Follow Xiao Zhan's official Instagram account for photos and updates.</p>
                        <p>International platform</p>
                    </div>
                    <div class="card-button">
                        <a href="https://www.instagram.com/xz_1991x/" class="btn instagram" target="_blank" data-platform="instagram-personal">Visit Instagram</a>
                    </div>
                </div>
            </div>
            
            <div class="social-card">
                <div class="card-header instagram">
                    <h2>ËÇñÊàòÂ∑•‰ΩúÂÆ§Instagram</h2>
                </div>
                <div class="card-body">
                    <div class="card-info">
                        <p>Follow XZ.STUDIO's official Instagram account for behind-the-scenes content.</p>
                        <p>Official studio account</p>
                    </div>
                    <div class="card-button">
                        <a href="https://www.instagram.com/xz.studio1005/" class="btn instagram" target="_blank" data-platform="instagram-studio">Visit Instagram</a>
                    </div>
                </div>
            </div>
            
            <div class="social-card">
                <div class="card-header youtube">
                    <h2>ËÇñÊàòÂ∑•‰ΩúÂÆ§YouTube</h2>
                </div>
                <div class="card-body">
                    <div class="card-info">
                        <p>Watch XZ.STUDIO's official videos and content on YouTube.</p>
                        <p>Official studio channel</p>
                    </div>
                    <div class="card-button">
                        <a href="https://www.youtube.com/@xzstudio-1005" class="btn youtube" target="_blank" data-platform="youtube-studio">Visit YouTube</a>
                    </div>
                </div>
            </div>
            
            <div class="social-card">
                <div class="card-header tencent">
                    <h2>ËÖæËÆØËßÜÈ¢ë</h2>
                </div>
                <div class="card-body">
                    <div class="card-info">
                        <p>Watch Xiao Zhan's shows and performances on Tencent Video.</p>
                        <p>Video platform</p>
                    </div>
                    <div class="card-button">
                        <a href="https://v.qq.com/x/search/?q=%E8%82%96%E6%88%98" class="btn tencent" target="_blank" data-platform="tencent-video">Watch Videos</a>
                    </div>
                </div>
            </div>
            
            <div class="social-card">
                <div class="card-header youku">
                    <h2>‰ºòÈÖ∑ËßÜÈ¢ë</h2>
                </div>
                <div class="card-body">
                    <div class="card-info">
                        <p>Find Xiao Zhan's dramas, interviews and performances on Youku.</p>
                        <p>Video platform</p>
                    </div>
                    <div class="card-button">
                        <a href="https://so.youku.com/search/q_%E8%82%96%E6%88%98" class="btn youku" target="_blank" data-platform="youku-video">Watch Videos</a>
                    </div>
                </div>
            </div>
            
            <div class="social-card">
                <div class="card-header iqiyi">
                    <h2>Áà±Â•áËâ∫ËßÜÈ¢ë</h2>
                </div>
                <div class="card-body">
                    <div class="card-info">
                        <p>Discover Xiao Zhan's content on iQIYI.</p>
                        <p>Video platform</p>
                    </div>
                    <div class="card-button">
                        <a href="https://www.iqiyi.com/search/%E8%82%96%E6%88%98.html" class="btn iqiyi" target="_blank" data-platform="iqiyi-video">Watch Videos</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- LATEST NEWS SECTION -->
        <div class="latest-news">
            <h2>Latest Updates</h2>
            <div class="news-item">
                <h3>New Drama/Movie Announcement</h3>
                <p>Xiao Zhan's captivating performance in "The Legend of the Condor Heroes" earns widespread acclaim. The upcoming film "De Xian Jin Zhi" and the TV series "Zang Hai Zhuan" are eagerly anticipated.</p>
            </div>
            
            <div class="news-item">
                <h3>Music Release</h3>
                <p>Xiao Zhan's latest album "WM" has been gaining popularity across music platforms in China.</p>
            </div>
        </div>
    </div>


<div class="container">
    <div class="work-item" style="text-align: center; margin-bottom: 40px;">
        <h3 class="work-title">Discover Xiao Zhan's Captivating Works</h3>
        <p class="work-description">Complete collection of dramas, movies, and shows</p>
        <div style="margin-top: 20px;">
            <a href="https://canadaxfx.github.io/XZworks/" target="_blank" class="btn" style="font-size: 1.1rem; padding: 10px 25px;">Complete Collection</a>
        </div>
    </div>
</div>

   
<!-- =============== CONTACT SECTION =============== -->
<div class="container">
    <div class="contact-section">
        <h2 class="section-title">Contact Us</h2>
        <form action="https://formsubmit.co/yvonzh@gmail.com" method="POST">
            <!-- Anti-spam honeypot field -->
            <input type="text" name="_honey" style="display:none">
            
            <!-- Disable captcha -->
            <!--<input type="hidden" name="_captcha" value="false"> -->
            
            <!-- Redirect after submission -->
            <input type="hidden" name="_next" value="https://canadaxfx.github.io/xiaozhan/">
            
            <div class="form-group">
                <label for="name">Your Name</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
                <label for="email">Your Email (Optional) </label>
                <input type="email" id="email" name="email" >
            </div>
            <div class="form-group">
                <label for="subject">Subject</label>
                <input type="text" id="subject" name="subject" required>
            </div>
            <div class="form-group">
                <label for="message">Message</label>
                <textarea id="message" name="message" required></textarea>
            </div>
            <button type="submit" class="submit-btn">Send Message</button>
        </form>
    </div>
</div>



    <footer class="footer">
        <p>This fan-made website by North American XFX is created for personal use only. All rights to images and content belong to their respective owners.</p>
        <p>Last updated: <span id="last-updated">April 2025</span></p>
    </footer>

<!-- Add this JavaScript code right before the closing </body> tag -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Define your playlist with track names and file paths
        const originalPlaylist = [
            { name: "XZ-ÈÉΩ‰∏ÄÊ†∑", file: "ÈÉΩ‰∏ÄÊ†∑.mp3" },
            { name: "XZ-ÁÅØÂ°î", file: "ÁÅØÂ°î.mp3" },
            { name: "XZ-ÊºÇÊµÅ", file: "ÊºÇÊµÅ.mp3" },
            { name: "XZ-‰∏çË¶ÅÂõûÂ§¥", file: "‰∏çË¶ÅÂõûÂ§¥.mp3" },
            { name: "XZ-Â¶ÇÊÑø", file: "Â¶ÇÊÑø.mp3" },
            { name: "XZ-ÂêåË∑Ø‰∫∫", file: "ÂêåË∑Ø‰∫∫.mp3" },
            { name: "XZ-‰ΩôÂπ¥", file: "‰ΩôÂπ¥.mp3" },
            { name: "XZ-ÊôöÂÆâ", file: "ÊôöÂÆâ.mp3" },
            // Add more tracks as needed
        ];
        
        // Create a working copy of the playlist that we can shuffle
        let playlist = [...originalPlaylist];
        
        const audioElement = document.getElementById('background-music');
        const musicToggle = document.getElementById('music-toggle');
        const prevButton = document.getElementById('prev-track');
        const nextButton = document.getElementById('next-track');
        const shuffleButton = document.getElementById('shuffle-toggle');
        const trackNameDisplay = document.getElementById('track-name');
        
        let currentTrackIndex = 0;
        let isPlaying = false;
        let isShuffled = false;
        
        // Initialize the first track
        function loadTrack(index) {
            const track = playlist[index];
            
            // Log to help debug
            console.log("Loading track:", track.name, "File path:", track.file);
            
            // Set the source and load the audio
            audioElement.src = track.file;
            audioElement.load(); // Explicitly load the audio file
            
            trackNameDisplay.textContent = track.name;
            trackNameDisplay.title = track.name; // For tooltip on hover
            
            // If music was playing before changing tracks, start playing the new track
            if (isPlaying) {
                const playPromise = audioElement.play();
                
                // Handle play promise properly
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        // Playback started successfully
                        console.log("Playback started for:", track.name);
                    }).catch(e => {
                        console.error('Playback prevented:', e);
                        isPlaying = false;
                        updatePlayButton();
                    });
                }
            }
        }
        
        // Update the play/pause button appearance
        function updatePlayButton() {
            musicToggle.innerHTML = isPlaying ? 
                '<span class="music-icon">‚è∏Ô∏è</span>' : 
                '<span class="music-icon">‚ñ∂Ô∏è</span>';
        }
        
        // Update shuffle button appearance
        function updateShuffleButton() {
            shuffleButton.style.backgroundColor = isShuffled ? 
                '#1a252f' : 'var(--primary-color)';
        }
        
        // Function to shuffle array using Fisher-Yates algorithm
        function shuffleArray(array) {
            let currentIndex = array.length;
            let temporaryValue, randomIndex;
            
            // While there remain elements to shuffle
            while (0 !== currentIndex) {
                // Pick a remaining element
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex -= 1;
                
                // Swap it with the current element
                temporaryValue = array[currentIndex];
                array[currentIndex] = array[randomIndex];
                array[randomIndex] = temporaryValue;
            }
            
            return array;
        }
        
        // Function to toggle shuffle mode
        function toggleShuffle() {
            const currentTrack = playlist[currentTrackIndex];
            
            if (isShuffled) {
                // Turn off shuffle - restore original playlist order
                playlist = [...originalPlaylist];
                isShuffled = false;
            } else {
                // Turn on shuffle - randomize the playlist
                playlist = shuffleArray([...originalPlaylist]);
                isShuffled = true;
            }
            
            // Find the current track in the new playlist order
            currentTrackIndex = playlist.findIndex(track => 
                track.file === currentTrack.file);
            
            // If somehow the track wasn't found, reset to first track
            if (currentTrackIndex === -1) currentTrackIndex = 0;
            
            updateShuffleButton();
        }
        
        // Function to toggle music play/pause
        function toggleMusic() {
            if (isPlaying) {
                audioElement.pause();
            } else {
                const playPromise = audioElement.play();
                
                if (playPromise !== undefined) {
                    playPromise.catch(e => {
                        console.error('Playback prevented:', e);
                    });
                }
            }
            isPlaying = !isPlaying;
            updatePlayButton();
        }
        
        // Function to play previous track
        function playPreviousTrack() {
            currentTrackIndex = (currentTrackIndex - 1 + playlist.length) % playlist.length;
            loadTrack(currentTrackIndex);
        }
        
        // Function to play next track
        function playNextTrack() {
            currentTrackIndex = (currentTrackIndex + 1) % playlist.length;
            loadTrack(currentTrackIndex);
        }
        
        // Add event listeners
        musicToggle.addEventListener('click', toggleMusic);
        prevButton.addEventListener('click', playPreviousTrack);
        nextButton.addEventListener('click', playNextTrack);
        shuffleButton.addEventListener('click', toggleShuffle);
        
        // When current track ends, play the next one
        audioElement.addEventListener('ended', function() {
            console.log("Track ended, playing next");
            playNextTrack();
        });
        
        // Add error handling for audio loading issues
        audioElement.addEventListener('error', function(e) {
            console.error('Audio loading error:', e);
            console.error('Failed to load:', playlist[currentTrackIndex].file);
            // Optionally try the next track
            // playNextTrack();
        });
        
        // Initialize the first track
        loadTrack(currentTrackIndex);
        
        // Set volume
        audioElement.volume = 0.5; // Set volume to 50%
        
        // Initialize shuffle button appearance
        updateShuffleButton();
    });
</script>

</body>
</html>